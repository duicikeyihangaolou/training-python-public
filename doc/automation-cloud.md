# 一体化云计算运维平台的架构和实现

## 注意 ⚠️

- _斜体表示引用_
- **未经允许，禁止转载**

## Prerequisite

- 熟悉 Linux 系统的基本配置和命令
- 熟悉 Python（或 Java / Golang） 编程语言
- 熟悉云平台（OpenStack / K8S / VMWare / 公有云）的基本操作
- 有虚拟化、容器、分布式或商用存储存储、云平台网络的配置经验更佳

## 课程内容

本课程涵盖云平台自动化运维相关的一般概念，包括：

1. 基础设施的选型、建设规划、最佳实践与常用技巧
2. 完整的一体化云平台运维实战，包括开发、设计、使用全流程。

概念和实战覆盖运维平台的基础功能：

1. CMDB
2. 运维 Agent
3. 监控
4. 脚本管理
5. 任务管理、任务流程编排
6. 数据可视化

关键词：Python，Linux，Docker，OpenStack，Kubernetes，Prometheus，Grafana

## 课程目标

- 较为深入完整地了解云平台运维技术栈
- 了解一体化云平台运维框架的设计和技术选型
- 掌握一体化云平台运维框架Demo的搭建、应用和扩展
- 了解云平台运维相关的前沿知识和发展趋势，理解 AIOps 的商业应用场景

## 课程目录

| 日程    | 时间 | 课程                                 | 内容                             |
| ----- | -- | ---------------------------------- | ------------------------------ |
| 第 1 天 | 上午 | [1. 一体化云平台运维架构](#1-一体化云平台运维架构)     | [1.1 基础设施云平台](#11-基础设施云平台)     |
|       |    |                                    | [1.2 云平台的建设规划](#12-云平台的建设规划)   |
|       | 下午 |                                    | [1.3 开源运维平台工具](#13-开源运维平台工具)   |
|       |    |                                    | [1.4 混合云运维平台设计](#14-混合云运维平台设计) |
| 第 2 天 | 上午 | [2. 云运维平台实战](#2-云运维平台实战)           | [2.1 运维平台的整体架构](#21-运维平台的整体架构) |
|       |    |                                    | [2.2 运维服务平台搭建](#22-运维服务平台搭建)   |
|       | 下午 |                                    | [2.3 运维平台基础功能](#23-运维平台基础功能)   |
| 第 3 天 | 上午 |                                    | [2.4 任务管理](#24-任务管理)           |
|       | 下午 |                                    | [2.5 监控和告警](#25-监控和告警)         |
|       |    | [3. 面向未来的云平台运维技术](#3-面向未来的云平台运维技术) | [3.1 AIOps](#31-aiops)         |

## 1. 一体化云平台运维架构

[返回目录](#课程目录)

### 1.1 基础设施云平台

[返回目录](#课程目录)

#### 1.1.1 云计算的上半场和下半场

计算和虚拟化的发展

1. 60-70 IBM，大型机：集中式计算
2. 80-90 VMWare，个人 PC：分布式计算
3. 2005-至今 Amazon，云计算+移动互联网：泛在计算。5G 边缘计算还在路上

云计算的分类

1. IaaS：是最为主流的云计算，以 AWS 为代表，是一种基于虚拟化技术的自助式服务平台
2. PaaS：GAE
3. SaaS：Office 365

云计算的上半场：

1. 百花齐放：开源云计算框架 + 开源生态，群雄逐鹿
2. 功能单一：IaaS 占绝大多数体量，PaaS / SaaS 在试水
3. 虚拟化 / 裸机 / 容器三者相对分离

云计算的下半场：

1. 公有云倾销私有云
   1. 公有云推私有化部署，称混合云
   2. 开源云计算框架热度减退，也趋于稳定，自主可控，开放原生，可定制成为最主要卖点
2. 融合和统一
   1. 算力统一调度成为主流：VMWare 的传统优势和新变化
   2. 接口统一：Kubenetes API 成为主流
   3. 广泛的服务和中间件
3. 更智慧
   1. AI 的发展衍生了各类智慧类垂直领域云，GPU 渲染云，AI 平台云等
   2. 算力调度云边协同等
   3. AIOps

#### 1.1.2 虚拟化

虚拟化的目的：1. 资源隔离，2. 资源限制

虚拟化使得在一台物理服务器上可以跑多台虚拟机。

虚拟化共享物理机的 CPU、内存、IO 硬件资源，但逻辑上虚拟机之间是相互隔离的物理机我们一般称为宿主机（Host），宿主机上面的虚拟机称为客户机（Guest）Hypervisor 程序将 Host
的硬件虚拟化，并提供给 Guest 使用，分为：全虚拟化（一型虚拟化）和半虚拟化（二型虚拟化）。

全虚拟化 Hypervisor 是一个特殊定制的 Linux 系统，直接安装在物理机上。比如 Xen 和 VMWare 的 EXSi。全虚拟化一般对硬件虚拟化功能做了特别优化，性能更好。

半虚拟化先安装标准操作系统，Hypervisor 作为 OS 上的一个程序模块运行，并对虚拟机进行管理。比如 KVM，VirtualBox，VMWare WorkStation，VMWare
Player，VMWare Fusion 等。半虚拟化基于普通操作系统，比较灵活，比如支持虚拟机嵌套（在 KVM 虚拟机中再运行 KVM）。

#### 1.1.3 云原生

1. 容器和安全容器
2. Kubernetes as a Service（EKS/ACK）
3. KoK
4. ASM
5. Devops

### 1.1.4 混合云的适用场景

### 1.1.5 块存储、文件存储和对象存储

### 1.1.6 SDN，SDNC 和 SDWAN

### 1.2 云平台的建设规划

[返回目录](#课程目录)

#### 1.2.1 企业云的一般需求和技术选型

1. 虚拟化、容器和裸金属的混合调度
2. 容器云即服务

#### 1.2.2 企业云架构的注意事项

2. 信创兼容性考量：指令集、操作系统、数据库、其他中间件
3. 分布式存储：性能调优 & 高可靠
4. 网络方案选型 & 高可用
5. 认证和安全

### 1.3 开源运维平台工具

[返回目录](#课程目录)

1. 运维场景中的常用Python模块
2. 自动化框架：Ansible
3. Ansible 的云平台相关模块
4. 任务管理：Jenkins & Zuul
5. 云原生时代的任务管理
6. 监控：Prometheus & Grafana

### 1.4 混合云运维平台设计

[返回目录](#课程目录)

1. 自动化是运维的灵魂
2. 声明式定义和幂等性
3. GitOps
4. 审计日志和回溯
5. 分析报表和可视化

## 2. 云运维平台实战

[返回目录](#课程目录)

### 2.1 运维平台的整体架构

[返回目录](#课程目录)

1. 需求分析
2. 功能列表
3. 整体架构设计
4. 简单性和可扩展性

### 2.2 运维服务平台搭建

[返回目录](#课程目录)

1. FastAPI web service
2. 文档和 Swagger
3. Vue.js vs React

### 2.3 运维平台基础功能

[返回目录](#课程目录)

#### 2.3.1 CMDB

#### 2.3.2 脚本管理

#### 2.3.3 运维 agent

1. SSH & Shell
2. Docker
3. ansible in pod
4. remote kubectl

### 2.4 任务管理

[返回目录](#课程目录)

#### 2.4.1 任务管理

1. 任务管理
2. 任务流程编排：Drone
3. 云原生任务流程编排：Tekton/建木
4. Workflow
5. 工单和审批系统

#### 2.4.2 任务流程编排

1. Jenkins / Zuul / Drone
2. Tekton / AlgoCD / 建木

### 2.5 监控和告警

[返回目录](#课程目录)

#### 2.5.1 监控方案

1. Prometheus + Thanos
2. AlertManager + Notification Gateway：站内信、短信、邮件、企业微信、钉钉

#### 2.5.2 数据可视化

1. 日志可视化：Grafana+Fluentbeat+Loki vs EFK
2. 监控可视化：Prometheus + Grafana
3. 分析报表
4. 大屏展示（配屏）

## 3. 未来的运维技术

[返回目录](#课程目录)

### 3.1 AIOps

[返回目录](#课程目录)

1. 什么是 AIOps
2. AIOps 的实现原理
3. AIOps 的权责设计
